<!DOCTYPE html>
<html>
<head>
    <title>Home</title>
    <!-- for-mobile-apps -->
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta name="keywords" content="" />
    <script type="application/x-javascript"> addEventListener("load", function() { setTimeout(hideURLbar, 0); }, false);
    function hideURLbar(){ window.scrollTo(0,1); } </script>
    <!-- //for-mobile-apps -->
    <link href="css/bootstrap.css" rel="stylesheet" type="text/css" media="all" />
    <link href="css/style.css" rel="stylesheet" type="text/css" media="all" />
    <!-- js -->
    <script src="js/jquery-1.11.1.min.js"></script>
    <!-- //js -->
    <!-- login-pop-up -->
    <script src="js/menu_jquery.js"></script>
    <!-- //login-pop-up -->
    <!-- animation-effect -->
    <link href="css/animate.min.css" rel="stylesheet">
    <script src="js/wow.min.js"></script>
    <script>
        new WOW().init();
    </script>
    <!-- //animation-effect -->
    <link href='https://fonts.googleapis.com/css?family=Open+Sans:400,300,300italic,400italic,600,600italic,700,700italic,800,800italic' rel='stylesheet' type='text/css'>
    <link href='https://fonts.googleapis.com/css?family=Oswald:400,300,700' rel='stylesheet' type='text/css'>
</head>

<body>
<!-- header -->
<div class="header-top">
    <div class="container">
        <div class="header-top-left animated wow slideInLeft" data-wow-delay=".5s">
            <p>&nbsp&nbsp&nbsp欢迎来到XX医疗预约网站&nbsp&nbsp&nbsp愿您终生健康</p>
        </div>
        <div class="header-top-left1 animated wow slideInLeft" data-wow-delay=".7s">
            <h1>联系我们<span class="glyphicon glyphicon-earphone" aria-hidden="true"></span></h1>
        </div>
        <div class="header-top-right">
            <span style="color: white;font-size: larger;">欢迎，XXX</span>
        </div>
        <div class="clearfix"> </div>
    </div>
</div>
<div class="header-nav">
    <div class="container">
        <nav class="navbar navbar-default">
            <!-- Brand and toggle get grouped for better mobile display -->
            <div class="navbar-header">
                <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
                    <span class="sr-only">Toggle navigation</span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                </button>
                <div class="logo animated wow slideInLeft" data-wow-delay=".5s">
                    <a class="navbar-brand" href="index.html">XX 医疗 <span>Hospital</span></a>
                </div>
            </div>

            <!-- Collect the nav links, forms, and other content for toggling -->
            <div class="collapse navbar-collapse nav-wil" id="bs-example-navbar-collapse-1">
                <ul class="nav navbar-nav">
                    <li><a href="index.html">首页</a></li>
                    <li class="active"><a href="personalappointment.html">预约中心</a></li>
                    <li><a href="personalrecord.html">个人病历</a></li>
                    <li><a href="patientcomment.html">评价主治医生</a></li>
                </ul>

                <div class="search">
                    <form>
                        <span class="glyphicon glyphicon-search" aria-hidden="true"></span><input type="email" class="text" value="Enter Your Text..." onfocus="this.value = '';" onblur="if (this.value == '') {this.value = 'Enter Your Text...';}" required="">
                    </form>
                </div>
            </div><!-- /.navbar-collapse -->

        </nav>
    </div>
</div>
<!-- //header -->
<!-- banner -->
<div class="banner">
    <div class="banner-pos banner1">
        <div class="container">
            <div class="banner-info animated wow slideInUp" data-wow-delay=".5s">
                <h2>
                    欢迎来到 <span>预约中心</span>
                </h2>
                <p>请选择您想要的预约内容</p>
            </div>
        </div>
        <div class="banner-posit animated wow zoomIn" data-wow-delay=".5s">
            <h2><span class="glyphicon glyphicon-calendar" aria-hidden="true"></span>开始预约</h2>
            <div class="reservation">
                <h5>日期</h5>
                <div class="book_date">
                    <form>
                        <span class="glyphicon glyphicon-calendar" aria-hidden="true"></span>
                        <input class="date" id="datepicker" type="date" value="2016-10-19" onfocus="this.value = '';" onblur="if (this.value == '') {this.value = '2016-10-19';}" required="">
                    </form>
                </div>
                <h5>时间</h5>
                <!----------start section_room----------->
                <div class="section_room">
                    <select id="timeSlot" onchange="change_country(this.value)" class="frm-field required">
                        <span class="glyphicon glyphicon-user" aria-hidden="true"></span><option value="1">8:00-11:00</option>
                        <option value="2">14:00-16:00</option>
                        <option value="3">16:00-18:00</option>
                    </select>
                </div>
                <h5>科目</h5>
                <!----------start section_room----------->
                <div class="section_room">
                    <select id="dept" onchange="change_country(this.value)" class="frm-field required sect">
                        <option value="内科">内科</option>
                        <option value="外科">外科</option>
                        <option value="妇科">妇科</option>
                        <option value="精神科">精神科</option>
                        <option value="儿童科">儿童科</option>
                    </select>
                </div>
                <div class="book">
                    <h5>备注（症状、个人情况等）</h5>
                    <form>
                        <span class="glyphicon glyphicon-envelope" aria-hidden="true"></span><textarea value="Message:" onfocus="this.value = '';" onblur="if (this.value == '') {this.value = 'Message';}">备注</textarea>
                        <input id="submit-btn" type="button" value="提交预约">
                    </form>
                </div>
            </div>
        </div>
    </div>
</div>


<!-- for bootstrap working -->
<script src="js/bootstrap.js"></script>
<script src="js/utils.js"></script>
<script src="js/patient.js"></script>
<script type="text/javascript">
    let user = utils.getCurrentUser()
    if(user){
        $(".header-top-right > span").text(user.username)
    }

    $("#submit-btn").click(function(){
        let user = utils.getCurrentUser()
        if(!user){
            alert("please login")
        }else{
            const date = $("#datepicker").val()
            const department = $("#dept").val()
            const timeSlot = $("#timeSlot").val()
            const note = $("textarea").val()

            console.log(department)
            
            const postData = {
                query: `mutation {
                    addAppointment(userId:${user.userId},department:"${department}", date:"${date}", timeSlot:${timeSlot}, note:"${note}")
                        {
                            user{userId username}
                            timeSlot
                            department
                            note
                        }
                    }`
            }

            utils.authPost("http://api.zhongnan.io/query", postData).then((res)=>{
                if (res.data){
                    alert("success")
                }else{
                    alert("fail")
                }
            })
        }
    })

</script>
<!-- //for bootstrap working -->
</body>
</html>